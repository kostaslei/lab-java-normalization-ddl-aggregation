use week6;

// Exersice 1
DROP TABLE IF EXISTS Articles;
DROP TABLE IF EXISTS Authors;


CREATE TABLE Authors
(
    author_id  INT AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name  VARCHAR(50) NOT NULL
);

CREATE TABLE Articles
(
    article_id INT AUTO_INCREMENT PRIMARY KEY,
    title      VARCHAR(255) UNIQUE NOT NULL,
    word_count INT                 NOT NULL,
    views      INT                 NOT NULL,
    author_id  INT                 NOT NULL,
    FOREIGN KEY (author_id) REFERENCES Authors (author_id)
);

INSERT INTO Authors (first_name, last_name) VALUES
                                                ('Maria', 'Charlotte'),
                                                ('Juan', 'Perez'),
                                                ('Gemma', 'Alcocer');

INSERT INTO Articles (title, word_count, views, author_id) VALUES
                                                               ('Best Paint Colors', 814, 14, 1),
                                                               ('Small Space Decorating Tips', 1146, 221, 2),
                                                               ('Hot Accessories', 986, 105, 1),
                                                               ('Mixing Textures', 765, 22, 1),
                                                               ('Kitchen Refresh', 1242, 307, 2),
                                                               ('Homemade Art Hacks', 1002, 193, 1),
                                                               ('Refinishing Wood Floors', 1571, 7542, 3);



// Exersice 2
use week6;

DROP TABLE IF EXISTS bookings;
DROP TABLE IF EXISTS customers;
DROP TABLE IF EXISTS flights;
DROP TABLE IF EXISTS aircrafts;



CREATE TABLE customers
(
    customer_id  INT AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name  VARCHAR(50) NOT NULL,
    status VARCHAR(20) NOT NULL,
    mileage int NOT NULL
);

CREATE TABLE aircrafts
(
    aircraft_id  INT AUTO_INCREMENT PRIMARY KEY,
    model VARCHAR(50) NOT NULL,
    seats int NOT NULL
);

CREATE TABLE flights
(
    flight_id INT AUTO_INCREMENT PRIMARY KEY,
    number      VARCHAR(20) UNIQUE NOT NULL,
    aircraft_id INT                 NOT NULL,
    mileage      INT                 NOT NULL,
    FOREIGN KEY (aircraft_id) REFERENCES aircrafts (aircraft_id)
);

CREATE TABLE bookings
(
    booking_id INT AUTO_INCREMENT PRIMARY KEY,
    customer_id      INT NOT NULL,
    flight_id INT                 NOT NULL,
    FOREIGN KEY (customer_id) REFERENCES customers (customer_id),
    FOREIGN KEY (flight_id) REFERENCES flights (flight_id)
);


INSERT INTO aircrafts (model, seats) VALUES
                                         ('Boeing 747', 400),
                                         ('Airbus A330', 236),
                                         ('Boeing 777', 264);

INSERT INTO customers (first_name, last_name, status, mileage) VALUES
                                                                   ('Agustine', 'Riviera', 'Silver', 115235),
                                                                   ('Alaina', 'Sepulvida', 'None', 6008),
                                                                   ('Tom', 'Jones', 'Gold', 205767),
                                                                   ('Sam', 'Rio', 'None', 2653),
                                                                   ('Jessica', 'James', 'Silver', 127656),
                                                                   ('Ana', 'Janco', 'Silver', 136773),
                                                                   ('Jennifer', 'Cortez', 'Gold', 300582),
                                                                   ('Christian', 'Janco', 'Silver', 14642);

INSERT INTO flights (number, aircraft_id, mileage) VALUES
                                                       ('DL143', 1, 135),
                                                       ('DL122', 2, 4370),
                                                       ('DL53', 3, 2078),
                                                       ('DL222', 3, 1765),
                                                       ('DL37', 1, 531);

INSERT INTO bookings (customer_id, flight_id) VALUES
-- Agustine Riviera
(1, 1),
(1, 2),
-- Alaina Sepulvida
(2, 2),
-- Tom Jones
(3, 2),
(3, 3),
(3, 4),
-- Sam Rio
(4, 1),
(4, 5),
-- Jessica James
(5, 1),
(5, 2),
-- Ana Janco
(6, 4),
-- Jennifer Cortez
(7, 4),
-- Christian Janco
(8, 4);


// Exercise 3
Total number of flights: 5
Average flight distance: 1775.8
Average number of seats per aircraft: 300
Average miles flown by customers, grouped by status:
    Silver: 98576.5000
    None: 4330.5000
    Gold: 253174.5000

Max miles flown by customers, grouped by status:
    Silver,136773
    None,6008
    Gold,300582

Number of aircrafts with "Boeing" in their name: 2
Flights with distance between 300 and 2000 miles:
    DL222,3,1765
    DL37,1,531

Average flight distance booked, grouped by customer status:
    Silver,2090.0000
    None,1678.6667
    Gold,2494.5000

Most booked aircraft among Gold status members: Boeing 777,3
